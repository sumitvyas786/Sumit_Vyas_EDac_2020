----------- **ASSIGNMENT 4*** -------------------- 
select * from employee;
select * from department;
SELECT * FROM MANAGER;

----------- (JOINS) -----------------
SELECT D.DEPT_NAME, E.EMP_NAME FROM DEPARTMENT D JOIN EMPLOYEE E ON D.DEPT_ID=E.DEPT_ID;
SELECT * FROM DEPARTMENT D JOIN EMPLOYEE E ON D.DEPT_ID=E.DEPT_ID;
SELECT D.DEPT_ID, SUM(E.SALARY) as SUM  FROM DEPARTMENT D JOIN EMPLOYEE E ON D.DEPT_ID=E.DEPT_ID GROUP BY D.DEPT_ID;
SELECT D.DEPT_NAME, E.EMP_NAME FROM EMPLOYEE E RIGHT OUTER JOIN DEPARTMENT D ON E.DEPT_ID=D.DEPT_ID; 
SELECT D.DEPT_NAME, E.EMP_NAME FROM EMPLOYEE E LEFT OUTER JOIN DEPARTMENT D ON E.DEPT_ID=D.DEPT_ID; 
-- CREATE TABLE MANAGER (MAN_ID INT primary KEY, NAME varchar(10));
-- INSERT INTO MANAGER VALUES(1,'RAM'),(2,'SHYAM'),(3,'GEETA'),(4,'SEETA');
SELECT E.EMP_NAME , M.NAME AS MANAGER FROM EMPLOYEE  E JOIN MANAGER M ON E.MANAGER=M.MAN_ID;
SELECT E.EMP_NAME , D.DEPT_NAME AS DEPARTMENT FROM EMPLOYEE  E JOIN DEPARTMENT D ON E.DEPT_ID=D.DEPT_ID;

----------- (UNION) -----------------
-- CREATE TABLE EMP1 (EMP_ID INT PRIMARY KEY, EMP_NAME VARCHAR(10));
-- INSERT INTO EMP1  VALUES(1,'A'),(2,'B'),(3,'C');
-- CREATE TABLE EMP2 AS SELECT * FROM EMP1;
SELECT * FROM EMP2;
-- INSERT INTO EMP2 VALUES (4,'D'),(5,'E');

-- 1
SELECT * FROM EMP1
UNION 
SELECT * FROM EMP1;
-- 2
SELECT * FROM EMP1
UNION ALL
SELECT * FROM EMP1;

----------- (SUBQUERY) -----------------

SELECT EMP_NAME FROM EMPLOYEE WHERE SALARY=(SELECT SALARY FROM EMPLOYEE WHERE EMP_NAME='Arun') AND EMP_NAME NOT LIKE 'ARUN';
SELECT EMP_NAME FROM EMPLOYEE WHERE DEPT_ID=(SELECT DEPT_ID FROM EMPLOYEE WHERE EMP_NAME='jack');
SELECT EMP_NAME FROM EMPLOYEE WHERE SALARY=(SELECT SALARY FROM EMPLOYEE ORDER BY SALARY LIMIT 1 );
UPDATE  EMPLOYEE SET SALARY=15000  WHERE DEPT_ID =
 (select dept_id from(SELECT DEPT_ID FROM employee  WHERE EMP_NAME='Max') as a) and EMP_NAME!='Max';

Update emp set sal = 1500 where deptid = (select deptid  from  emp where empname = 'max');
